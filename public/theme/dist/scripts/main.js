var Camry={},Help={};Help.Transform=function(e){var s=["","-webkit-","-ms-"],t="";return $.each(s,function(s,n){t+=n+"transform:"+e+";"}),t},Camry.yesScreen=function(){if($(".js-yes-screen").length){var e,s,t=this,n=$(".js-yes-screen"),a=n.find(".js-yes-cont"),i=(n.find(".js-yes-list"),$(".wrapper"),!1),o={height:360,width:610};this.setHtml=function(){for(var e=Dictionary.KSP,s=0,t="",n=0;n<e.length;n++)t+='<div class="yes-screen__option empty-option-before"></div>';$.each(e,function(e,n){var a="",i=n.ksp.length-1;$.each(n.ksp,function(e,t){a+='                    <div data-td="'+s+'" data-tr="'+i+'" class="list__other-item js-ksp" data-option-id="'+n.id+'" data-ksp-id="'+t.id+'">                        <div class="other-item__opened">                            <div class="opened__top-title">'+n.name+'</div>                            <div class="opened__bottom">                                <div class="opened__title">'+t.title+'</div>                                <div class="opened__desc">'+t.desc+'</div>                            </div>                        </div>                      <div class="other-item__content">                        <div class="other-item__background" style="background-image: url('+t.image+');">                          <div class="background__text">'+t.preview+'</div>                        </div>                      </div>                      <div class="other-item__line"></div>                    </div>',i--}),t+='<div data-id="'+s+'" class="yes-screen__option js-yes-option">              <div class="yes-screen__cont">                <div class="list__other-items">                  '+a+'                </div>                <div class="list__main-item" style="background-image: url('+n.image+');"></div>                <div class="list__option-name">'+n.name+'</div>                <div class="list__nav"><a href="#" class="nav__minus js-ksp-remove"><span>-</span></a><a href="#" class="nav__plus js-ksp-add opened"><span>+</span></a></div>              </div>            </div>',s++});for(var n=0;n<e.length;n++)t+='<div class="yes-screen__option empty-option-after"></div>';if($(".js-yes-screen .js-yes-cont").html(t),$.cookie("ksps")){var a=JSON.parse($.cookie("ksps"));$.each(a.items,function(e,s){$('.js-ksp[data-ksp-id="'+s+'"]').addClass("opened")})}},this.start=function(){var e=-16.375;a.attr("style",Help.Transform("translateY("+e+"rem)"))},this.kspNav=function(){var e=function(e){var s=$('.js-yes-screen .js-yes-option[data-id="'+e+'"]'),t=s.find(".js-ksp");if(t.filter(".opened").length){var a=t.filter(".opened").first().prev();a.addClass("opened")}else{var a=t.last();a.addClass("opened")}a.addClass("active");var i,o=t.attr("data-option-id"),r=t.filter(".opened").first().attr("data-ksp-id");$.each(Dictionary.KSP,function(e,s){s.id==o&&$.each(s.ksp,function(e,s){s.id==r&&(i=s.image)})});var d=$('<div class="main-item__background" style="background-image: url('+i+');"></div>');s.find(".list__main-item").append(d),setTimeout(function(){a.removeClass("active"),setTimeout(function(){d.addClass("active")},1e3)},1e3),n(s)},s=function(e){var s=$('.js-yes-screen .js-yes-option[data-id="'+e+'"]'),t=s.find(".js-ksp"),a=s.find(".main-item__background").last().removeClass("active");t.filter(".opened").first().removeClass("opened"),setTimeout(function(){a.remove()},500),n(s)},t=function(e){e.find(".js-ksp-remove").removeClass("opened"),e.addClass("empty-option")},n=function(){var e={},s=[];$(".js-ksp.opened").each(function(){var e=$(this).attr("data-ksp-id");s.push(e)}),e.items=s;var n=JSON.stringify(e);$.cookie("ksps",n),$("#yessubmit").find("input").val(n),$(".js-yes-screen .js-yes-option").each(function(){var e=$(this);e.removeClass("empty-option"),$(this).find(".js-ksp.opened").length?($(this).find(".js-ksp-remove").addClass("opened"),$(this).find(".js-ksp.opened").length==$(this).find(".js-ksp").length?$(this).find(".js-ksp-add").removeClass("opened"):$(this).find(".js-ksp-add").addClass("opened")):($(this).find(".js-ksp-add").addClass("opened"),t(e))})};$(document).on("click",".js-ksp-add",function(){if(!$(this).hasClass("opened"))return!1;var s=$(this).parents(".js-yes-option").attr("data-id");return e(s),!1}),$(document).on("click",".js-ksp-remove",function(){if(!$(this).hasClass("opened"))return!1;var e=$(this).parents(".js-yes-option").attr("data-id");return s(e),!1}),n()},this.navigation={left:function(){var e=parseInt(s)-1;t.open(0,e)},right:function(){var e=parseInt(s)+1;t.open(0,e)},top:function(){var n=parseInt(e)+1;t.open(n,s)},bottom:function(){var n=parseInt(e)-1;t.open(n,s)}},this.close=function(){t.start(),$(".yes-overlay").removeClass("active"),$(".js-yes-screen .empty-option-before, .empty-option-after").removeClass("show"),n.removeClass("opened"),$(".js-yes-option").siblings().attr("style",Help.Transform("translateY(0)")),$(".yes-main-btn").removeClass("to-back"),$(".yes-navigation").fadeOut().removeClass("opened"),$(".footer").addClass("to-front"),i=!1},this.open=function(r,d){var l=0,c=0,p=$('.js-ksp[data-tr="'+r+'"][data-td="'+d+'"]');if(i){if(!p.length||!p.hasClass("nav_active"))return!1}else i=!0,l=500,c=350;e=r,s=d,$(".footer").removeClass("to-front"),$(".yes-navigation").fadeIn().addClass("opened"),$(".yes-main-btn").addClass("to-back");var v=($(".js-yes-option").not(".empty-option"),p.parents(".js-yes-option")),f=v.nextAll(".js-yes-option").not(".empty-option").length,m=v.prevAll(".js-yes-option").not(".empty-option").length;$(".js-yes-screen .empty-option-before, .empty-option-after").removeClass("show");var u=2*(3-d);if(u>0)for(var h=0;u>h;h++)$(".js-yes-screen .empty-option-before").eq(h).addClass("show");else{u=-1*u;for(var h=0;u>h;h++)$(".js-yes-screen .empty-option-after").eq(h).addClass("show")}$(".js-ksp").removeClass("nav_active"),p.addClass("nav_active");var y=(parseInt(d)+1,parseInt(d)-1,parseInt(r)+1),j=parseInt(r)-1;v.nextAll(".js-yes-option").not(".empty-option").eq(0).find('.js-ksp.opened[data-tr="0"]').addClass("nav_active"),v.prevAll(".js-yes-option").not(".empty-option").eq(0).find('.js-ksp.opened[data-tr="0"]').addClass("nav_active"),$('.js-ksp.opened[data-td="'+d+'"][data-tr="'+y+'"]').addClass("nav_active"),$('.js-ksp.opened[data-td="'+d+'"][data-tr="'+j+'"]').addClass("nav_active"),$(".js-ksp").removeClass("active-ksp"),p.addClass("active-ksp"),setTimeout(function(){$(".js-yes-screen .empty-option-before, .empty-option-after").removeClass("show");var e=m-f;if(e>0)for(var s=0;e>s;s++)$(".js-yes-screen .empty-option-after").eq(s).addClass("show");else{e=-1*e;for(var s=0;e>s;s++)$(".js-yes-screen .empty-option-before").eq(s).addClass("show")}var t=-$(document).height()+$(document).height()/2+o.height/2,i=$(".ksp-opened-sample").height()*r;n.addClass("opened"),$(".yes-overlay").addClass("active"),setTimeout(function(){a.attr("style",Help.Transform("translateY("+t+"px)")),v.attr("style",Help.Transform("translateY("+i+"px)")).siblings().attr("style",Help.Transform("translateY(0)"))},c)},l),t.setNav()},this.setNav=function(){var t=$('.js-ksp[data-tr="'+e+'"][data-td="'+s+'"]'),n=t.parents(".js-yes-option");n.nextAll(".js-yes-option").not(".empty-option").eq(0).find('.js-ksp.opened[data-tr="0"]').length?$(".nav__right").removeClass("disabled"):$(".nav__right").addClass("disabled"),n.prevAll(".js-yes-option").not(".empty-option").eq(0).find('.js-ksp.opened[data-tr="0"]').length?$(".nav__left").removeClass("disabled"):$(".nav__left").addClass("disabled");var a=parseInt(e)+1,i=parseInt(e)-1;n.find('.js-ksp.opened[data-tr="'+a+'"]').length?$(".nav__top").removeClass("disabled"):$(".nav__top").addClass("disabled"),n.find('.js-ksp.opened[data-tr="'+i+'"]').length?$(".nav__bottom").removeClass("disabled"):$(".nav__bottom").addClass("disabled")},this.setEvents=function(){$(document).on("click",".js-ksp",function(){return i&&!$(this).hasClass("nav_active")?(t.close(),!1):(t.open($(this).attr("data-tr"),$(this).attr("data-td")),!1)}),$(document).on("click",".yes-overlay",function(){return t.close(),!1}),$(document).on("click",".js-yes-list",function(e){return($(e.target).hasClass("js-yes-list")||$(e.target).hasClass("js-yes-cont"))&&t.close(),!1}),$(document).on("click",".nav__right",function(){return t.navigation.right(),!1}),$(document).on("click",".nav__bottom",function(){return t.navigation.bottom(),!1}),$(document).on("click",".nav__top",function(){return t.navigation.top(),!1}),$(document).on("click",".nav__left",function(){return t.navigation.left(),!1}),$(document).on("keydown",function(e){var s=e.which;40==s&&(e.preventDefault(),t.navigation.bottom())}),$(document).on("keydown",function(e){var s=e.which;38==s&&(e.preventDefault(),t.navigation.top())}),$(document).on("keydown",function(e){var s=e.which;37==s&&(e.preventDefault(),t.navigation.left())}),$(document).on("keydown",function(e){var s=e.which;39==s&&(e.preventDefault(),t.navigation.right())}),$(document).on("click",'#yessubmit [type="submit"]',function(e){e.preventDefault();var s=$(this).parents("form");return console.log(s.find("input").val()),s.submit(),!1})},this.init=function(){t.setHtml(),t.start(),t.setEvents(),t.kspNav(),$(".footer").addClass("to-front")},t.init()}},Camry.noScreen=function(){if($(".js-no-screen").length){{var e=this,s=$(".js-no-screen"),t=s.find(".js-yes-cont");s.find(".js-yes-list"),$(".wrapper")}this.setHtml=function(){for(var e=Dictionary.NoScreen,s=0,t="",n=0;n<e.length;n++)t+='<div class="yes-screen__option empty-option-before"></div>';$.each(e,function(e,n){var a="",i=n.ksp.length-1;$.each(n.ksp,function(e,t){a+='                    <div data-td="'+s+'" data-tr="'+i+'" class="list__other-item js-ksp" data-option-id="'+n.id+'" data-ksp-id="'+t.id+'">                      <div class="other-item__line"></div>                    </div>',i--}),t+='<div data-option-id="'+n.id+'" data-id="'+s+'" class="yes-screen__option js-yes-option">              <div class="yes-screen__cont">                <div class="list__other-items">                  '+a+'                </div>                <div class="list__option-name">'+n.name+'</div>                <div class="list__nav"><a href="#" class="nav__minus js-ksp-remove"><span>-</span></a><a href="#" class="nav__plus js-ksp-add opened"><span>+</span></a></div>              </div>            </div>',s++});for(var n=0;n<e.length;n++)t+='<div class="yes-screen__option empty-option-after"></div>';$(".js-no-screen .js-yes-cont").html(t)},this.start=function(){var e=-16.375;t.attr("style",Help.Transform("translateY("+e+"rem)"))},this.kspNav=function(){var e=function(e){var s=$('.js-no-screen .js-yes-option[data-id="'+e+'"]'),n=s.find(".js-ksp");if(n.filter(".opened").length){var a=n.filter(".opened").first().prev();a.addClass("opened")}else{var a=n.last();a.addClass("opened")}t(s)},s=function(e){var s=$('.js-no-screen .js-yes-option[data-id="'+e+'"]'),n=s.find(".js-ksp");n.filter(".opened").first().removeClass("opened"),t(s)},t=function(){var e={};$(".js-no-screen .js-yes-option").each(function(){var s=$(this).attr("data-option-id"),t=$(this).find(".js-ksp.opened").length;e[s]=t});var s=JSON.stringify(e);$("#nosubmit input").val(s),$(".js-no-screen .js-ksp").hasClass("opened")?($(".js-no-submit").removeAttr("disabled"),$(".js-no-submit").removeAttr("onclick")):($(".js-no-submit").attr("onclick","return false;"),$(".js-no-submit").attr("disabled","disabled")),$(".js-no-screen .js-yes-option").each(function(){$(this).find(".js-ksp.opened").length?($(this).find(".js-ksp-remove").addClass("opened"),$(this).find(".js-ksp.opened").length==$(this).find(".js-ksp").length?$(this).find(".js-ksp-add").removeClass("opened"):$(this).find(".js-ksp-add").addClass("opened")):($(this).find(".js-ksp-add").addClass("opened"),$(this).find(".js-ksp-remove").removeClass("opened"))})};$(document).on("click",".js-ksp-add",function(){if(!$(this).hasClass("opened"))return!1;var s=$(this).parents(".js-yes-option").attr("data-id");return e(s),!1}),$(document).on("click",".js-ksp-remove",function(){if(!$(this).hasClass("opened"))return!1;var e=$(this).parents(".js-yes-option").attr("data-id");return s(e),!1}),$(document).on("click",'#nosubmit [type="submit"]',function(e){e.preventDefault();var s=$(this).parents("form");return console.log(s.find("input").val()),s.submit(),!1}),t()},this.init=function(){e.setHtml(),e.start(),e.kspNav()},e.init()}},Camry.Carousel=function(){$(".js-carousel").jcarousel(),$(".js-carousel-prev").on("jcarouselcontrol:active",function(){$(this).removeClass("inactive")}).on("jcarouselcontrol:inactive",function(){$(this).addClass("inactive")}).jcarouselControl({target:"-=1"}),$(".js-carousel-next").on("jcarouselcontrol:active",function(){$(this).removeClass("inactive")}).on("jcarouselcontrol:inactive",function(){$(this).addClass("inactive")}).jcarouselControl({target:"+=1"})},Camry.KSPs=function(){var e=$(".item__block");e.on("mouseover",function(e){return $(e.target).hasClass("item__hover")||$(e.target).parents(".item__hover").length?!1:void $(this).find(".item__hover").fadeIn(250)}).on("mouseout",function(){$(this).find(".item__hover").hide()}),$(".item__hover").on("mouseover",function(){$(this).hide()}),$(".list__item-small").each(function(){var e=$(this).find(".item__block").eq(1).offset().left-$(document).width()/2;0>e&&$(this).addClass("hover-right")})},Camry.ShowMobile=function(){var e=new MobileDetect(window.navigator.userAgent);if((e.mobile()||e.phone()||e.tablet())&&1!=$.cookie("ShowSite"))throw $(".js-mobile-screen").show(),$(".js-content").hide(),$(".js-show-site").on("click",function(){return $.cookie("ShowSite",1),window.location.href=window.location.href,!1}),new Error("This site isn't for mobile devices")},Camry.Validate=function(e,s){function t(e){var s=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return s.test(e)}e.on("submit",function(n){n.preventDefault();var a=!0,i="Сообщение не отправленно.";return 0==e.find('[name="name"]').val().length?(e.find('[name="name"]').addClass("input-error"),i+=" Введите ФИО.",a=!1):e.find('[name="name"]').removeClass("input-error"),t(e.find('[name="email"]').val())?e.find('[name="email"]').removeClass("input-error"):(e.find('[name="email"]').addClass("input-error"),i+=" Поле e-mail введено некорректно.",a=!1),0==e.find('[name="message"]').val().length?(e.find('[name="message"]').addClass("input-error"),i+=" Введите сообщение.",a=!1):e.find('[name="message"]').removeClass("input-error"),a?(e.find(".js-form-errors").text(""),s(e)):e.find(".js-form-errors").text(i),!1})},$(function(){Camry.ShowMobile(),Camry.Validate($("#why-form"),function(e){var s=$(".js-form-final"),t={beforeSubmit:function(){$(e).find('[type="submit"]').addClass("loading").attr("disabled","disabled")},success:function(){e.slideUp(),s.slideDown(),$(e).find('[type="submit"]').removeClass("loading").removeAttr("disabled")},error:function(){$(e).find('[type="submit"]').removeClass("loading").removeAttr("disabled")}};$(e).ajaxSubmit(t)}),Camry.KSPs(),Camry.Carousel(),Camry.yesScreen(),Camry.noScreen(),autosize(document.querySelectorAll("textarea")),$(".yes-overlay").blurjs({source:".yes-screen-back .main-layer",radius:175}),$("#parallax-scene").parallax({limitY:.1})});